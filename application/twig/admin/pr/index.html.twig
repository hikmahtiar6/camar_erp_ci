{% extends 'admin/layout.html.twig' %}

{% block content_title %}
	
{% endblock %}

{% block content %}

	<div class="row clearfix">

		<div class="col-md-12 col-sm-12 col-xs-12">

			<div class="card" style="width: 100%; margin: 0 auto !important;">

				<div class="header">
					<h2>
						Daftar Purchase Request
					</h2>
				</div>
				
				<div class="body">

					<a class="btn btn-primary waves-effect" href="{{ site_url('admin/pr/edit/new') }}">
						Tambah
					</a>
					<br>
					<br>

					<table class="table table-bordered" style="width: 80%">
						<thead>
							<tr>
								<td class="bold"  style="width: 10px;">No.</td>
								<td class="bold">No. Dokumen</td>
								<td class="bold">Vendor</td>
								<td class="bold">Tanggal Transaksi</td>
								<td class="bold">Sudah diposting ?</td>
								<td class="bold">Jumlah Die</td>
								<td class="bold"></td>
							</tr>
						</thead>
						<tbody>
							
						{% if data_headers %}
							{% for key, row_header in data_headers %}
								<tr>
									<td align="right">{{ key + 1 }}</td>
									<td>
										<a href="{{ site_url('admin/pr/edit/' ~ row_header.PurchaseRequestHeaderId) }}">
											{{ row_header.PurchaseRequestNo }}
										</a>
									</td>
									<td>
										{{ row_header.Initial }}
									</td>
									<td>{{ indonesian_date(row_header.TransactionDate, 'three') }}</td>
									<td align="center">
										{% if same(row_header.PostedDate, '') %}
											<span class="color-red" title="belum">
												<i class="material-icons">remove</i>
											</span>
										{% else %}
											<span class="color-green" title="sudah">
												<i class="material-icons">check</i>
											</span>
										{% endif %}
									</td>
									<td>
										{{ count_die_pr_by_header(row_header.PurchaseRequestHeaderId) }}
									</td>
									<td align="center">
										<a class="btn btn-xs btn-success" href="{{ site_url('admin/pr/print_out/' ~ row_header.PurchaseRequestHeaderId) }}" title="Print" target="_blank">
											<i class="material-icons">insert_drive_file</i>
										</a>

										{% if same(row_header.PostedDate, '') %}
											<span class="btn btn-xs btn-danger delete-header-pr" data-id="{{ row_header.PurchaseRequestHeaderId }}" title="Hapus">
												<i class="material-icons">delete</i>
											</span>
										{% else %}
										{% endif %}
									</td>
								</tr>
							{% endfor %}
						{% else %}
							<tr>
								<td colspan="7">Data tidak tersedia</td>
							</tr>
						{% endif %}
						</tbody>
					</table>	
					
				</div>
				
			</div>

		</div>

	</div>

{% endblock %}

{% block javascript %}
	{{ parent() }}

	<script type="text/javascript" src="{{ base_url('assets_app/js/pr.js') }}"></script>
	<script type="text/javascript" src="{{ base_url('assets_app/js/date.js') }}"></script>
	<script type="text/javascript">
		window.DATE.init();
		window.PR.handleDeleteHeader();
	</script>

{% endblock %}